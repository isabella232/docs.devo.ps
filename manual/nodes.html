<!DOCTYPE html>
<html>
<head>
  <title>devo.ps &raquo; Nodes</title>

  <!-- Meta -->
  <link rel='shortcut icon' href='/assets/images/favicon.ico' />
  <meta charset='utf-8'/>
  <meta name='viewport' content='width=device-width, initial-scale=1'/>
  
  
  <!-- CSS -->
  <!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,700,300' rel='stylesheet' type='text/css'> -->
  <link href='/assets/styles.css' rel='stylesheet' type='text/css'/>
</head>
<body>
  <section id='content'>
    
<header class='header'>
    <div class='controls'>
        <a href='#'>Permalink</a>
  </div>

  <h1>Nodes</h1>
</header>

<section class='body'>
  <h2 id="overview">Overview</h2>
<p>Nodes are the core component of <code>devops</code>, to make it simple, you can consider a <code>node</code> is a server.  </p>
<p>Nodes are described in a yaml format, with 1 node per file. Nodes files must be saved in the <code>nodes</code> folder.</p>
<h2 id="file-format">File format</h2>
<p>A node is described in a YAML file. It <strong>must</strong> be named as the node.id.</p>
<pre><code>shell&gt; cat ./nodes/myserver.yml

---
id: myserver
name: My Awesome Server
type: server
disabled: false

provider:
  type: digitalocean
  size: 66
  region: 3
  image: ubuntu13.10    

services: {}
configuration: {}
</code></pre><h3 id="format-details">Format details</h3>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td><code>string</code></td>
<td><code>true</code></td>
<td></td>
<td>The ID of the node, it must match the filename</td>
</tr>
<tr>
<td><strong>name</strong></td>
<td><code>string</code></td>
<td><code>true</code></td>
<td></td>
<td>The name of the server, will appear on the web interface</td>
</tr>
<tr>
<td><strong>type</strong></td>
<td><code>string</code></td>
<td><code>true</code></td>
<td></td>
<td>Type of the node, currently only <code>server</code> is supported</td>
</tr>
<tr>
<td><strong>disabled</strong></td>
<td><code>bool</code></td>
<td><code>false</code></td>
<td><code>false</code></td>
<td>Whether or not consider the node as disabled</td>
</tr>
<tr>
<td><strong>provider</strong></td>
<td><code>object</code></td>
<td><code>true</code></td>
<td></td>
<td>The provider&#39;s detail of the node, used on provisioning, see the <a href="/references/providers.html">providers references</a> for more details</td>
</tr>
<tr>
<td><strong>services</strong></td>
<td><code>object</code></td>
<td><code>true</code></td>
<td></td>
<td>The services to install on the node, see the References section for the list of supported services</td>
</tr>
<tr>
<td><strong>configuration</strong></td>
<td><code>object</code></td>
<td><code>true</code></td>
<td></td>
<td>The configuration for each of the services defined in the <code>services</code></td>
</tr>
</tbody>
</table>
<h2 id="git-operations">Git operations</h2>
<h3 id="on-push-file-validation">On push - File validation</h3>
<p>On <code>git push</code>, the file will be parsed and validated by the <code>devops</code> platform. If the file is not valid, the push will be rejected. You will need to fix the file before pushing again.</p>
<h3 id="file-creation">File creation</h3>
<p>On commit / push of a new node on git, the node will be provisioned on the provider defined in the file.</p>
<p>It will use the cloud provider API credentials defined in your profile. Obviously any attempt to create a node on an invalid provider or on a provider for which no credentials are found in the profile will fail.</p>
<h3 id="file-delete">File delete</h3>
<p>Removing a node from the repository is interpreted by <code>devops</code> as a request to effectively remove the server. The server will be stopped and destroyed.</p>
<h3 id="file-update">File update</h3>
<p>Adding or removing a service, updating the configuration of a service will lead to a sync of the node. After a few minutes the node will have the services and configuration as described in the <code>yaml</code> file.</p>
<p><strong>Notes</strong>:</p>
<ul>
<li>Modifying the <strong><code>provider</code></strong> information will trigger no change (no resize, no migration to another provider); the provider details is only used on provisioning.</li>
<li>Toggling the <strong><code>disabled</code></strong> attribute between <code>False</code> and <code>True</code> will in practice delete (an existing) / create (a disabled) node. It is a convenient way to keep the node definition in your git repository and use it as a temporary node spawned on demand.</li>
</ul>
<h2 id="users-on-node">Users on node</h2>
<p>Several users are created on the server:</p>
<ul>
<li><code>devops</code>: is used by the devops platform to<ul>
<li>maintain your server in sync with its YAML definition</li>
<li>execute <a href="/manual/Tasks.html">tasks</a></li>
</ul>
</li>
<li><code>{user}</code>: is created for you to get access to the server. <ul>
<li><code>{user}</code> is your username on the devo.ps website. </li>
<li>The SSH public keys defined in your profile have been added to the <code>authorized_keys</code>. </li>
</ul>
</li>
<li><code>{collaborators}</code>: one user per collaborator of your git repository is created on the server; for example if <code>bob</code> and <code>alice</code> are collaborator on your <code>myrepo</code> repository, they will also be able to access the server.</li>
</ul>
<h2 id="access-to-the-node">Access to the node</h2>
<p>The access to the node is provided over SSH. The IP address is available on the web interface on the node details page.</p>
<p>You can access your server with the following command (with <code>{user}</code> being your devops username):</p>
<pre><code>ssh {user}@{ip_address}
</code></pre><p>If you have installed the <a href="/manual/CLI.html">CLI</a>, you can also use the following commands:</p>
<pre><code># From anywhere on your workstation
devops ssh --repo=repo node_id

# From your repo folder (the repo is guessed from there)
devops ssh node_id

# Even simpler if you only have 1 node defined and you are in your repo folder...
devops ssh
</code></pre>
</section>



  </section>

  <aside id='sidebar'>
    <header class='header'>
      <h2>devo.ps documentation</h2>
    </header>
    <section class='body'>
      <ul>
  <li><a href='/'>Getting started</a></li>
  <li><a href='/overview.html'>Overview</a></li>
  <li>
    <h3>Manual</h3>
    <ul>
      <ul>
<li><a href="/manual/Getting-Started.html">Getting Started</a></li>
<li><a href="/manual/Git.html">Git</a><ul>
<li><a href="/manual/Nodes.html">Nodes</a></li>
<li><a href="/manual/Tasks.html">Tasks</a></li>
<li><a href="/manual/Scripts.html">Scripts</a></li>
</ul>
</li>
<li><a href="/manual/CLI.html">CLI</a></li>
</ul>

    </ul>
  </li>
  <li>
    <h3>References</h3>
    <ul>
      
      <li><a href='/references/apache.html'>Apache</a></li>
      
      <li><a href='/references/php.html'>PHP</a></li>
      
    </ul>
  </li>
</ul>

    </section>
    <footer class='footer'>
      <a href='http://devo.ps'><span>Go to devo.ps</span></a>
    </footer>
  </aside>
  
  <!-- JS -->
  <!--[if lt IE 9]><script src='http://html5shim.googlecode.com/svn/trunk/html5.js'></script><![endif]-->
  <script type='text/javascript' src='/assets/scripts.js'></script>
	
  
</body>
</html>
